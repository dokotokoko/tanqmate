# Vibes 探Q 要件定義書

## 1. プロダクト概要l

### 目的

高校生の探究学習において、活動が停滞する場面（何をしていいか分からない、面白くない）を乗り越えるため、「自分の探究テーマや興味との関連性」をトリガーとした“面白そう！”という感情を引き出すUXを提供する。これにより、「何をしたら良いかわからない」「どうしたら良いかわからない」という停滞状態から、次の行動へ自然に遷移できるよう支援する。

### ターゲットユーザー

* 高校生（主に総合的な探究の時間での利用）
* 学校授業中のPCやタブレットからアクセスする利用環境

### 解決したい課題

* テーマ設定後や初期リサーチ後の「何をしたら良いかわからない」「どうしたら良いかわからない」「何もしたくない」という停滞（行動の迷い）
* 探究となると「考える」が先行してしまって、「わからないことをまず調べる」をできなくなる（情報の提示）  

---

## 2. ユースケース

### ユースケース1：授業中の探究中に手が止まっている生徒

高校2年生のAさんは、「プラスチックごみ問題」をテーマに探究学習を進めていたが、情報収集の途中で「これ以上、何をすればいいのか分からない」と手が止まってしまった。AさんはVibe 探Qにログインし、現在のテーマや進捗状況（探究段階：情報収集中）を入力・更新する。すると、Vibe 探Qのクエスト機能がAさんの興味と状況にマッチした小さなアクションを提案する。例えば「プラスチックごみ問題について、1番「なんとかしたい」と思ったことを1つ選ぶ」「プラスチックごみ問題について1番みんなに知って欲しいと思ったことを、先生か友達に話してみる」というクエストが表示される。Aさんは提案に従って1番なんとかしたい！と思う課題を友達に伝えて意見交換をしてみた。クエストをこなすうちに、自分の探究テーマに関連する具体的な論点（例えば「地域でのリサイクル活動の課題」）が見え始め、次に進む方向性が明確になる。

同時に、タイムライン機能にはAさんのテーマや興味に関連した話題が表示されている。タイムラインには「最近のプラスチックごみ削減に関する社会のホットなニュース」や「他校の生徒によるリサイクル活動の探究事例紹介」といった投稿が流れてくる。Aさんはその中の一つ、「高校生が地域で実践したプラスチック回収プロジェクトの記事」を興味深く読み、自身の探究に新たな視点を得た。また、タイムライン上のニュースから得たキーワードをきっかけに、自分の探究テーマに関連する新たな疑問も生まれ、探究の方向を広げることにつながった。

Vibe 探QはAさんの行動を記録し、コンテキスト情報を更新する。Aさんが完了したクエスト内容や閲覧した記事キーワードはコンテキストに蓄積され、サービスは「興味がプラスチックごみ問題からリサイクル技術にも広がった」「探究段階が情報収集から整理・分析フェーズに進みつつある」等の状態変化を把握する。これにより、次回ログイン時にはより現在の関心に適合したクエスト提案やタイムライン情報が提示されることになる。結果としてAさんは停滞を脱し、「自分ごと」として探究テーマに向き合う意欲を取り戻してプロジェクトを継続できた。

### ユースケース2：授業の冒頭で「今日は何するか？」を決める場面

新たに探究テーマを設定したばかりのBさんは、何から手を付けて良いかわからず途方に暮れている。Vibe 探Qを起動してみると、登録の過程で「探究テーマ」「興味があること」「やっていて楽しいこと」を選ばされた。登録後の画面では、選択した情報に従ってクエスト機能が「テーマに関連する身近な疑問を3つ書き出してみましょう」といった最初の一歩となるタスクを提案する。Bさんが疑問を書き出すと、次のクエストとして「書き出した疑問の中から特に気になるものを一つ選び、家族や友人にインタビューして意見を聞いてみましょう」という提案が出される。Bさんはインタビューを通じてテーマへの関心を深め、探究の方向性を定めることができた。またタイムラインには、同じテーマに取り組んだ先輩生徒の発表事例動画が流れており、それを見ることで「自分もこんな発表をしてみたい」という目標イメージが湧いてきた。こうして探究活動の初期段階からVibe 探Qが伴走し、生徒の興味喚起と方向付けを支援する。

---

## 3. 機能一覧

| 機能カテゴリ   | 機能名        | 概要                              |
| -------- | ---------- | ------------------------------- |
| コンテキスト取得 | テーマ・興味タグ入力UI | 生徒が探究テーマ（自由入力）と興味タグ（候補から選択）を登録する。|
|          | 現在地選択      | 探究の進行段階をフェーズから選択（例：調査中、仮説形成中など） |
           | やっていて楽しいこと選択    | 日常の中で自分がやっていて楽しいことを選択 |
|          | ログ記録       | 各種アクション（閲覧・選択・実行）を行動ログとして記録し、履歴と文脈に基づく提示改善に活用する。 |
| 情報提示     | クエスト提示     | 生徒のテーマ・タグ・現在地に応じて、選択可能な3件の行動提案（調べる・視点を変える等）を提示。UXに配慮したタイトルと説明を伴う。|
|          | タイムライン提示   | 興味・タグ・テーマに基づき、関連性が高くタイムリーなニュース・事例を最大3件提示。探究テーマと現実社会を接続する。|

---

## 4. 各機能の要件詳細
4. 各機能の要件詳細

以下では、主要機能ごとに入力・出力、前提条件、具体的な仕様について詳細を記述する。

4.1 クエスト機能の要件詳細

概要：
クエスト機能は、生徒に対し学習意欲を喚起する**小さな課題（クエスト）**を提示する。目的は、生徒が「次に何をすればよいか分からない」という停滞状態から抜け出し、自発的に行動を起こせるよう支援することである。クエスト内容は生徒ごとにパーソナライズされ、探究の進行状況に合わせて段階的にステップアップしていくものとする。クエストは身近で興味を持ちやすい題材を用いることで、生徒に「自分にもできそう」「面白そう」と感じさせる工夫を盛り込む。

入力：生徒のコンテキスト情報である。
(a)生徒の興味・関心（テーマに関連するキーワードやタグ）
(b)現在の探究段階（例：「問いの設定」「情報収集」「整理・分析」「まとめ・発表」等）
(c)過去に提案・実行済みのクエスト履歴
(d)生徒の希望やフィードバック（難易度の好み、興味の方向性の変化）

また、クエストの提案には内部で管理するクエストコンテンツのデータベース（多数のクエスト候補のテンプレート集）が参照される。各クエストテンプレートには対象とする興味分野や難易度、想定所要時間、探究段階適性などのメタ情報が付与されており、提案時にマッチングに用いる。

出力：生徒に提示されるクエストカード（1件または複数件）。クエストカードには課題のタイトル、具体的な指示内容、想定所要時間、必要に応じて参考例（例：「○○のポイントを3つ書こう」「インタビュー質問リスト例を見る」等へのリンク）を含む。複数の候補クエストを提示し生徒が選択できる形とする（提案が合わない場合の代替案提示による柔軟性確保）。生徒が「クエストを実行済み」とマークできるインタラクションも提供し、完了時には達成チェックやフィードバック入力画面を出力する。

前提条件：生徒の基本コンテキスト（テーマまたは興味タグ、探究段階）が事前に設定されていることが前提となる。少なくとも初回利用時に生徒は自分の探究テーマや現在感じている課題感（「情報収集中だが行き詰まり」「分析結果のまとめ方が分からない」等）を入力するフローを経ていること。またクエストコンテンツDBに十分な種類の課題テンプレートが用意されていることも前提である。教科や分野をまたがる多様なテーマに対応するため、クエストコンテンツは継続的に拡充・メンテナンスされる必要がある。

仕様：クエスト提案機能の主な仕様項目は以下の通り：

選定ロジック： 独自の探究クエスト生成エンジンをLLMベースで開発し、入力されたコンテキストをもとに「その探究の段階における正しさ」の最適化ではなく、生徒の「面白そう」を指標としたクエストを選定する。マッチングロジックとしては、コンテキスト内の興味キーワードとクエストテンプレートのメタデータをキーワードマッチング・ルールベースで照合し、さらに探究段階に適した難易度・種類の課題にフィルタする。必要に応じてレコメンデーションアルゴリズム（将来的には協調フィルタリングや強化学習の活用も検討）を用いて、生徒の過去の選好に似た他の学習者のデータから「面白さ」最適クエストをランキングする仕組みも採用する。

UI/UX： 提案されたクエストは学習者に抵抗感を与えないよう工夫する。1つの提案は高校生にとって認知負荷が低いタスク（探究学習で発生する行動の多くは、高校生になるまでの間に経験しないタスクなのでヒュースリスティクが発生しづらく認知負荷が高い）とする。また未完了のクエストはプロフィール上で一覧でき、進行状況が可視化される。

フィードバック： 生徒がクエストを完了またはスキップする際、その結果を記録する。完了時には「難易度は適切だったか」「新たな発見はあったか」といった簡易アンケートを表示し、生徒自身のメタ認知を促すとともに、そのフィードバックを次回以降の提案精度向上に活用する。スキップが多いクエストは難易度調整または提案頻度の見直しを行う（コンテンツ改善サイクルへの入力）。

4.2 タイムライン機能の要件詳細

概要：タイムライン機能は、探究の文脈を広げる情報提供を目的とした機能である。生徒の設定したテーマや関心に関連する社会の最新動向、学術トピック、話題のネット記事などを収集し、時系列のフィード（タイムライン）として提示する。UI/UXの参考には、Google Chrome（スマホ）の、「Discover」機能が最も近い。生徒はこれを閲覧することで、自分の探究テーマが社会とどう結びついているかを知り、新たな視点やアイデアを得ることが期待される。

入力：タイムライン表示アルゴリズムへの入力は、生徒のコンテキスト情報（興味タグ、テーマキーワード、探究分野カテゴリ等）およびコンテンツデータソースから取得した記事・事例情報である。コンテンツデータソースには以下のものが含まれる：

ニュースデータ：一般のニュースサイトや教育向けニュースフィードから取得した最新記事情報（例：科学技術ニュース、社会問題トピックなど）。必要に応じてキーワードクローリングや提携メディアからのフィードを利用する。

探究事例データ：他校や過去年度の生徒による探究学習の優秀事例データベース。発表レポートやコンテスト入賞作品の概要、探究プロジェクトの進め方などをメタデータ付きで収録する。

ソーシャルQA/フォーラム：生徒同士や有識者とのQ&A掲示板、探究に関するSNS投稿等から、人気の話題や参考になる問答を抽出する（将来的な拡張機能として検討）。

システムは定期的（例：毎日）にこれらソースから関連コンテンツを収集・更新し、各コンテンツに対してタグ付け（自然言語処理を用いたキーワード抽出や話題分類）を行う。タイムライン生成時には生徒の興味タグとコンテンツのタグのマッチング、閲覧履歴との重複排除（既読コンテンツは極力再表示しない）などの処理が入力として考慮される。

出力：生徒の画面に表示されるタイムライン（フィード）。最新のコンテンツから順にカード形式で一覧表示され、各カードにはタイトル、概要（サマリー）、情報源、配信日時、関連タグ等が示される。カードをクリック/タップすれば詳細ページや外部記事へのリンクが開き全文を閲覧できる。出力されるタイムラインはスクロール可能で、過去のコンテンツも一定量まで遡って閲覧できるようにする。また、重要度やパーソナルな関連度の高いものは上位に表示されるアルゴリズムとし、生徒は「新着順」「関連度順」などソート順を切り替えるオプションも持つ。さらに、各コンテンツカード上には「興味深い」「参考になった」等の簡易リアクションボタンを設け、生徒が関心を示したものをフィードバックとして記録する。将来的にはこのリアクションデータも出力内容のパーソナライズ精度向上に活用する。

前提条件：ニュースや事例等の外部コンテンツを取得するためのデータ連携基盤が動作していることが前提となる（RSSフィードやAPI経由の定期データ取得）。また校内事例データなどを扱う場合は、適切な許諾を得てデータベース化されていることが必要である。生徒のコンテキスト情報（特に興味タグやテーマ）がある程度具体化していることも前提となる。もし生徒の興味情報が未設定の場合、タイムラインには汎用的な学習トレンド（例：探究スキルに関する記事や各分野の入門記事など）を表示する初期動作とする。

仕様：タイムライン機能の主要な仕様は以下の通り：

コンテンツ更新頻度： 外部ニュース・話題データは1日数回（朝・夕など）自動クローリングまたは提携先からの提供を受けて更新する。探究事例データベースは新規事例が追加されたタイミングで随時更新する。システムは最新取得日時を記録し、それ以降の新着コンテンツをタイムラインに追加する。

パーソナライズロジック： 生徒コンテキストの興味タグとコンテンツのタグマッチ度合いに基づきスコアリングを行う。例えば、コンテキストに「環境」「プラスチック問題」とあれば、それらに関連するタグを持つニュース（環境問題カテゴリの記事）や事例（環境課題に取り組んだ探究事例）に高スコアを与え上位に表示する。一方、直接の関連は薄くとも汎用的に有益な情報（探究スキルの磨き方等）は一定確率で混ぜることで、視野を広げる効果を狙う。アルゴリズムはコンテンツ多様性にも配慮し、同一タグ・同一テーマに偏りすぎないよう調整する。

フィルタリングと健全性： 教育用途にふさわしくない不適切なコンテンツ（暴力的・扇情的表現等）はフィルタリング除外する。また外部リンクについては信頼性チェックを行い、事前にホワイトリスト化したドメインからの情報のみを表示する設定も可能とする。生徒はタイムライン上で「興味ない」コンテンツを非表示にするオプションも持ち、そうしたユーザ操作も将来のレコメンド精度向上に反映する。

UI/UX： タイムラインは直感的なSNSライクなインタフェースとし、生徒がスマートフォンでも見やすいようカードを縦長に配置し視認性を高める。各カードにはコンテンツ種別を示すラベル（例：「NEWS」「事例」「Q&A」）や発信元アイコンを付与して一目で内容が把握できるようにする。閲覧済みのカードは既読表示を行い、新着との区別をつける。生徒はカードをブックマークしてマイリストに保存することもでき、後で参照可能とする。

4.3 コンテキスト取得・更新機能の要件詳細

概要：コンテキスト取得・更新機能は、生徒一人ひとりの**学習状況データ（コンテキスト）**を継続的に収集・管理する裏方の機能である。コンテキストには、生徒が入力した探究テーマの文章やキーワード、興味・関心タグ、現在の探究活動のステージ、過去の行動履歴（閲覧した記事や完了したクエストの履歴）などが含まれる。これらの情報は、生徒への提案内容をパーソナライズするために欠かせないものであり、本サービスの中核データとして扱われる。コンテキスト更新機能は、生徒の新たな入力やアクション発生時に呼び出され、記録をアップデートして他機能から参照可能にする役割を担う。

入力：コンテキスト更新ロジックに対する入力は多岐にわたる。主なものは以下の通り：

生徒の明示的入力データ： 探究テーマの文章（自由記述テキスト）、テーマに付与したタグ（生徒自身が選択した興味キーワード）、自己評価する探究段階（初期設定時に「今は情報収集段階」等を選択させる場合）など。

生徒の行動データ（ログ）： クエスト提案に対するアクション（「実行済みにした日時」「スキップした」等）、タイムラインでのアクション（「○○の記事をクリック」「▼▼の事例にいいねを押した」等）、その他システム上の操作履歴（ログイン頻度、テーマ変更履歴など）。

システムからの分析データ： 入力されたテーマ文章から抽出したキーワードリスト（自然言語処理で名詞や固有名詞を自動抽出した結果）、生徒の興味分野クラスタ分類結果（例：入力キーワードから推定される分野カテゴリ：環境科学、社会課題、経済　等）、探究段階推定結果（行動パターンから見た現在のステージ推定）など。これらは内部分析モジュールが生成し、コンテキスト更新時に統合される。

出力：更新された生徒コンテキスト情報が出力となる。具体的にはデータベース上の「生徒コンテキスト」レコードが新しい値で保存され、以降のクエスト提案やタイムライン生成の際に参照される。出力データの例としては、「生徒ID=123のコンテキスト：テーマ='プラスチックごみ問題'、タグ=['環境','リサイクル']、探究段階='情報収集'、未完了クエスト=[Q5,Q8]、直近完了クエスト=[Q2]、閲覧記事タグ=['海洋プラスチック','法規制']、…」といった状態情報である。これらのコンテキストデータは必要に応じてリアルタイムでメモリ上にもキャッシュされ、高速な参照を可能にする。さらに更新後、一部の情報はユーザ画面にもフィードバックされる（例：プロフィールページに現在の探究段階や興味タグが表示更新される、等）。

前提条件：本機能が正しく動作するためには、まず生徒が最低限の初期情報を登録している必要がある。テーマやタグが未設定の場合はコンテキストデータが空となり提案精度が下がるため、サービス利用開始時にチュートリアルを兼ねてテーマ入力・タグ選択を行うフローが必須となる。また行動ログ取得のため、サービス全体で適切なイベントトラッキング設計がなされていること（各種ユーザ行動が漏れなくシステムに記録されること）が前提となる。データベースおよびストレージ基盤が安全に運用されていること（ログの蓄積量に耐えうる容量とパフォーマンス）も前提条件である。

仕様：コンテキスト取得・更新機能の具体仕様は以下の通り：

データスキーマ： コンテキスト情報のスキーマ設計は後述の「データ構造」章で定義する。テーマ文はテキスト型、興味タグは可変長リスト、探究段階は定義済みカテゴリ、行動ログは時系列のリレーションを持つなど、データ型と関係性を定義する。更新処理はこのスキーマに則って行われる。

更新タイミング： 生徒の各種操作にフックしてコンテキスト更新を行う。例えば「テーマ変更ボタン押下時」「クエスト完了報告時」「記事閲覧時」に対応するイベントリスナーを設置し、トランザクション内で該当生徒レコードを更新する。必要に応じて更新頻度を制御し（頻繁な閲覧操作はバッチ処理でまとめて反映する等）、パフォーマンスとデータ鮮度のバランスを取る。

履歴管理とステート推移： コンテキスト更新時には過去の値を履歴テーブルに退避させ、時系列で学習者の状態推移を追跡できるようにする。例えば探究段階が「情報収集」から「分析」に変化した日時を記録しておくことで、後から学習プロセスを振り返る分析が可能となる。また更新された探究段階は生徒自身にも通知またはUI表示することで、自分の進捗を自覚できるようにする。

プライバシーとアクセス制御： コンテキストデータには個人の学習状況というセンシティブ情報が含まれるため、取扱いには十分注意する。生徒本人および所属教員・指導者以外は閲覧できないアクセス権限を設定し、分析用途で第三者が利用する際も匿名加工するなどの措置を行う。加えて、生徒が自らのコンテキストデータをダウンロードしたり削除要求できるよう、プライバシーポリシーに則った機能を提供する（コンテキストデータのポータビリティや消去に対応）。

### 4.1 テーマ・タグ入力

* 入力方式：自由入力＋タグ候補から選択（最大3つ）
* 保存形式：`{ user_id, theme_text, interest_tags[], vibes_actions[], created_at }`

### 4.2 探究の現在地（最近何に困っている？相談したいことはある？）入力

* 選択肢：初期5段階（例：①テーマ決定中、②調査中、③仮説立案中、④検証準備、⑤まとめ中）
* UI：ラジオボタン式、1つのみ選択可能
* 保存形式：`{ user_id, progress_stage, updated_at }`

### 4.3 クエスト提示

* 入力：ユーザーの`theme_text`, `interest_tags`, `progress_stage`
* 処理：独自の探究クエスト生成エンジンをLLMベースで開発する
* 出力：最大3件のクエスト（タイトル・説明・所要時間・期待される変化）

### 4.4 タイムライン提示

* 入力：`theme_text`および`interest_tags`
* 情報源：News API（教育用途に適した安全な記事ソース）
* 出力：最大3件の情報（タイトル・要約・出典・投稿日）

### 4.5 行動ログ記録

* イベント種別：`view`, `click`, `done`, `dismiss`
* 対象：`quest`, `timeline`
* 保存形式：

```json
{
  "user_id": "abc123",
  "event_type": "done",
  "target_type": "quest",
  "target_id": "q_001",
  "context_snapshot": {
    "theme": "地元の川の環境問題",
    "tags": ["環境", "地域"],
    "stage": "調査中"
  },
  "timestamp": "2026-01-05T13:10:00Z"
}
```

---

## 5. データ構造

### コンテキストスキーマ

| 項目             | 型             | 説明              |
| -------------- | ------------- | --------------- |
| theme_text     | string        | テーマ概要（自由記述）     |
| interest_tags  | array[string] | 選択された関心タグ |
| vibes_actions  | array[string] | 選択されたやってて楽しいことタグ |
| progress_stage | string        | 探究の現在地          |
| created_at     | datetime      | 初回登録日時          |

### 行動ログスキーマ

| 項目               | 型        | 説明                                 |
| ---------------- | -------- | ---------------------------------- |
| user_id          | string   | 学習者ID                              |
| event_type       | enum     | `view`, `click`, `done`, `dismiss` |
| target_type      | enum     | `quest`, `timeline`                |
| target_id        | string   | 該当クエストやニュースID                      |
| context_snapshot | object   | その時点でのコンテキスト状態                     |
| timestamp        | datetime | 実行時刻                               |

---

## 6. 非機能要件

### UI/UX

* 授業中に使いやすい軽量UI（遅延2秒以内）

### パフォーマンス・拡張性

* 初期ユーザー：同時接続100人
* APIレスポンス：1秒以内
* 将来的なコンテキスト推論・推薦モデルに対応可能なDB設計

### 制約条件

* 広告なし・商用ニュースは明示出典・著作権配慮
* 生徒の個人情報は記録しない（匿名ID）

---

## 7. KPIと評価指標

| 指標名     | 定義                                   | 目標値（初期）      |
| ------- | ------------------------------------ | ------------ |
| 行動遷移率   | クエスト or タイムラインを見た後、1つでも `done` を押す割合 | 30%以上        |
| クエスト選択率 | クエスト提示後、1つ以上クリックされた割合                | 50%以上        |
| 入力完了率   | テーマ＋タグ＋現在地を入力完了したユーザーの割合             | 70%以上        |
| 継続率     | 次回以降も再ログインして使ったユーザーの割合               | 40%以上（1週間以内） |
